<%- contentFor('style') %>
<link rel="stylesheet" type="text/css" href="/stylesheets/details.css" />

<%- contentFor('main') %>
<div class="content-wrapper" style="<%= backdrop_style %>">
  <div class="content">
    <div class="poster">
      <img alt="<%= title %> poster" src="<%= poster_path %>" />
    </div>
    <div class="details">
      <h1 class="details-title">
        <%= title %> <span>(<%= release_year %>)</span>
      </h1>
      <span class="details-subtitle">
        <%= release_date %> (BR) &nbsp; &bull; &nbsp; <%= genre %> &nbsp; &bull;
        &nbsp; <%= running_time %>
      </span>
      <div class="details-actions">
        <div class="details-actions-rating" style="<%= rating_style %>">
          <svg width="84" height="84">
            <circle fill="#081C22" r="40" cx="42" cy="42" />
            <circle
              class="ring"
              stroke="#1C4027"
              stroke-width="4"
              fill="transparent"
              r="32"
              cx="42"
              cy="42"
            />
            <circle
              class="progress-ring"
              stroke="#21D07A"
              stroke-width="4"
              fill="transparent"
              r="32"
              cx="42"
              cy="42"
              id="progressring"
            />
            <text
              x="42"
              y="49"
              text-anchor="middle"
              stroke="#ffffff"
              stroke-width="2px"
              fill="#ffffff"
              font-family="Source Sans Pro, sans-serif"
              font-size="24px"
            >
              <%= mean %>
            </text>
          </svg>
          <div class="details-actions-rating-text">
            Avaliação<br />
            dos<br />
            usuários
          </div>
        </div>
        <div class="details-actions-button">
          <i class="fas fa-list"></i>
          <div class="details-actions-button-tooltip-gallery">
            Adicionar à galeria
          </div>
        </div>
        <div class="details-actions-button">
          <i class="fas fa-star"></i>
          <div class="details-actions-button-tooltip-favorites">
            <div class="slidecontainer">
              <input type="range" min="1" max="100" value="<%= aval%>" class="slider" id="myRange">
              <span>Nota: <span id="demo"></span></span>
            </div>
          </div>
        </div>
        <a target="_blank" rel="noopener noreferrer" href="<%= trailer_path %>">
          <div class="details-actions-trailer">
            <i class="fas fa-play"></i>Reproduzir trailer
          </div>
        </a>
      </div>
      <div class="details-sinopsis">
        <h2 class="details-sinopsis-title">Sinopse</h2>
        <p class="details-sinopsis-text"><%= description %></p>
      </div>
    </div>
  </div>
</div>
<div class="comments">
  <h2>Comentários</h2>
  <div class="new-comment-container">
    <form id="new-comment-form" name="new-comment-form">
      <label for="new-comment">Faça uma comentário!</label>
      <textarea
        id="new-comment"
        name="new-comment"
        placeholder="O que achou desse filme?"
      ></textarea>
    </form>
    <button type="submit" form="new-comment-form" value="Submit">Enviar</button>
  </div>
  <% for(var i=0; i < commentaries.length; i++) { %>
  <div class="comment-container">
    <div class="comment-content">
      <h3><%= commentaries[i].profile.name %></h3>
      <span><%= commentaries[i].date %></span>
      <p><%= commentaries[i].text %></p>
    </div>
  </div>
  <% } %>
</div>
<script type="text/javascript">
  var progressoCirculo =  23.5 * parseFloat(<%= mean %>);
  document.getElementById("progressring").style.strokeDasharray = progressoCirculo;
</script>
<script>
  var slider = document.getElementById("myRange");
  var output = document.getElementById("demo");
  output.innerHTML = parseFloat(slider.value)/10;

  slider.oninput = function() {
    output.innerHTML = parseFloat(this.value)/10;

  }
</script>