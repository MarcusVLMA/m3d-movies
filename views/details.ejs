<%- contentFor('style') %>
<link rel="stylesheet" type="text/css" href="/stylesheets/details.css" />

<%- contentFor('main') %>
<div id="notificationModal" class="modal">
  <div class="modal-wrapper">
    <div class="modal-content">
      <img class="check-circle" src="/images/check-circle.svg" />
      <p id="modal-text" class="modal-text">.</p>
    </div>
  </div>
</div>
<div class="content-wrapper" style="<%= backdrop_style %>">
  <div class="content">
    <div class="poster">
      <img alt="<%= title %> poster" src="<%= poster_path %>" />
    </div>
    <div class="details">
      <h1 class="details-title">
        <%= title %> <span>(<%= release_year %>)</span>
      </h1>
      <span class="details-subtitle">
        <%= release_date %> (BR) &nbsp; &bull; &nbsp; <%= genre %> &nbsp; &bull;
        &nbsp; <%= running_time %>
      </span>
      <div class="details-actions">
        <div class="details-actions-rating" style="<%= rating_style %>">
          <svg width="84" height="84">
            <circle fill="#081C22" r="40" cx="42" cy="42" />
            <circle
              class="ring"
              stroke="#1C4027"
              stroke-width="4"
              fill="transparent"
              r="32"
              cx="42"
              cy="42"
            />
            <circle
              class="progress-ring"
              stroke="#21D07A"
              stroke-width="4"
              fill="transparent"
              r="32"
              cx="42"
              cy="42"
            />
            <text
              x="42"
              y="49"
              text-anchor="middle"
              stroke="#ffffff"
              stroke-width="2px"
              fill="#ffffff"
              font-family="Source Sans Pro, sans-serif"
              font-size="24px"
            >
              <%= vote_average %>
            </text>
          </svg>
          <div class="details-actions-rating-text">
            Avaliação<br />
            dos<br />
            usuários
          </div>
        </div>
        <% if(user) {%> <% if(titleIsInUserGallery) { %>
        <div
          id="details-actions-button"
          class="details-actions-button"
          onclick="removeTitleFromUserGallery(<%= id %>)"
        >
          <i id="details-actions-button-icon" class="fas fa-times"></i>
          <div
            id="details-actions-button-tooltip-gallery"
            class="details-actions-button-tooltip-gallery"
          >
            Remover da galeria
          </div>
        </div>
        <% } else {%>
        <div
          id="details-actions-button"
          class="details-actions-button"
          onclick="addTitleToUserGallery(<%= id %>)"
        >
          <i id="details-actions-button-icon" class="fas fa-list"></i>
          <div
            id="details-actions-button-tooltip-gallery"
            class="details-actions-button-tooltip-gallery"
          >
            Adicionar à galeria
          </div>
        </div>
        <% } %>
        <div class="details-actions-button">
          <i class="fas fa-star"></i>
          <div class="details-actions-button-tooltip-favorites">
            <span>70%</span>
            <svg width="180" height="10">
              <line
                x1="0"
                y1="5"
                x2="180"
                y2="5"
                stroke-width="6"
                stroke="#a2a2a2"
              />
              <line
                id="fav"
                x1="0"
                y1="5"
                x2="126"
                y2="5"
                stroke-width="6"
                stroke="#ffffff"
              />
            </svg>
          </div>
        </div>
        <% } %>
        <a target="_blank" rel="noopener noreferrer" href="<%= trailer_path %>">
          <div class="details-actions-trailer">
            <i class="fas fa-play"></i>Reproduzir trailer
          </div>
        </a>
      </div>
      <div class="details-sinopsis">
        <h2 class="details-sinopsis-title">Sinopse</h2>
        <p class="details-sinopsis-text"><%= description %></p>
      </div>
    </div>
  </div>
</div>
<div class="comments">
  <h2>Comentários</h2>
  <% if(user) {%>
  <div class="new-comment-container">
    <form id="new-comment-form" name="new-comment-form">
      <label for="new-comment">Faça uma comentário!</label>
      <textarea
        id="new-comment"
        name="new-comment"
        placeholder="O que achou desse filme?"
      ></textarea>
    </form>
    <button type="submit" form="new-comment-form" value="Submit">Enviar</button>
  </div>
  <% } %> <% for(var i=0; i < commentaries.length; i++) { %>
  <div class="comment-container">
    <div class="comment-content">
      <h3><%= commentaries[i].profile.name %></h3>
      <span><%= commentaries[i].date %></span>
      <p><%= commentaries[i].text %></p>

      <% if (user && user.role == 'ADMIN') {%>
      <i
        id="delete-commentary-icon"
        class="fas fa-trash"
        onclick="removeCommentary(<%= commentaries[i].id %>)"
      ></i>
      <% } %>
    </div>
  </div>
  <% } %>
</div>

<script type="text/javascript" src="/javascripts/details.js"></script>
